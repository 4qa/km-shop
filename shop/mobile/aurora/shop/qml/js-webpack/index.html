<!DOCTYPE html>
<html lang="en" style="height: 100%; width: 100%;">

<head>
    <meta charset="utf-8">
    <title>KMM Test</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="./kmm.min.js"></script>
</head>

<body>
    <script type="text/javascript">
        function action1() {
            async function action1() {
                try {
                    const categories = await kmm.AppHttpClient.get.categoriesPublished()
                    send(`${categories.toArray().length}`)
                } catch (e) {
                    send(e)
                }
            }
            send("Loading...")
            setTimeout(action1, 3000)
        }

        function action2() {
            async function action2() {
                try {
                    const categories = await kmm.AppHttpClient.get.categoriesPublished()
                    send(`${categories.toArray().length}`)
                } catch (e) {
                    send(e)
                }
            }
            send("Loading...")
            setTimeout(action2, 1000)
        }

        function send(response) {
            const caller = kmm.Helper.getCaller();
            var customEvent = new CustomEvent("framescript:log", {detail: {
                response: response,
                caller: caller
            }});
            document.dispatchEvent(customEvent);
        }
    </script>
</body>
</html>

